<!DOCTYPE html>
<html>
<head>
    <title>Braincore Buttons</title>
    <meta charset="UTF-8">
    <meta name="viewport" content=
    "width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
     tailwind.config = {
         theme: {
             extend: {
                 colors: {
                     'notion-dark': '#2F3437'
                 }
             }
         }
     }
    </script>
</head>
<body class="bg-white dark:bg-notion-dark">
    <div class="flex flex-row gap-4 justify-end">
        <form id="create-entry" name="create-entry">
            <button type="submit" class="bg-green-400 rounded-sm px-1 py-2">
                Deploy
            </button>
        </form>
    </div>
    <script>
     const createEntryForm = document.getElementById('create-entry')

     async function onSubmit (e) {
         e.preventDefault()

         const params = new URLSearchParams(window.location.search || '?')
         const token = params.get('api_token')


         const response = await fetch('/repos/eccentric-j/braincore/dispatches', {
             method: 'POST',
             mode: 'cors',
             headers: {
                 'Content-Type': 'application/json',
                 'Authorization': `Bearer ${token}`
             },
             body: JSON.stringify({
                owner: 'eccentric-j',
                repo: 'braincore',
                event_type: 'create-entry'
             })
         })

         const json = await response.json()

         console.log('response', json)
     }

     createEntryForm.addEventListener('submit', onSubmit)
    </script>
</body>
</html>
